{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _flattenRuns = require('./flattenRuns');\n\nvar _flattenRuns2 = _interopRequireDefault(_flattenRuns);\n\nvar _AttributedString = require('../models/AttributedString');\n\nvar _AttributedString2 = _interopRequireDefault(_AttributedString);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar fontSubstitution = function fontSubstitution(engines) {\n  return function (attributedString) {\n    var string = attributedString.string,\n        runs = attributedString.runs;\n    return engines.fontSubstitutionEngine.getRuns(string, runs);\n  };\n};\n\nvar scriptItemization = function scriptItemization(engines) {\n  return function (attributedString) {\n    return engines.scriptItemizer.getRuns(attributedString.string);\n  };\n};\n\nvar preprocessRuns = function preprocessRuns(engines) {\n  return function (attributedString) {\n    var fontRuns = fontSubstitution(engines)(attributedString);\n    var scriptRuns = scriptItemization(engines)(attributedString);\n    var stringRuns = attributedString.runs.map(function (run) {\n      var _run$attributes = run.attributes,\n          font = _run$attributes.font,\n          attributes = (0, _objectWithoutProperties3.default)(_run$attributes, ['font']);\n      return (0, _extends3.default)({}, run, {\n        attributes: attributes\n      });\n    });\n    var runs = (0, _flattenRuns2.default)([].concat(stringRuns, fontRuns, scriptRuns));\n    return new _AttributedString2.default(attributedString.string, runs);\n  };\n};\n\nexports.default = preprocessRuns;","map":null,"metadata":{},"sourceType":"script"}